2025-09-22 00:01:33 | INFO | src.data_ingestion.base_ingestion:run_ingestion:139 | Starting ingestion job: completely_free_stock_data
2025-09-22 00:01:33 | INFO | src.data_ingestion.base_ingestion:run_ingestion:142 | Extracting data...
2025-09-22 00:01:33 | INFO | src.data_ingestion.completely_free_stock_data:extract_data:59 | Extracting 100% free data for 10 tickers from 2024-09-22 00:01:33.382808 to 2025-09-22 00:01:33.382808
2025-09-22 00:01:33 | INFO | src.data_ingestion.completely_free_stock_data:extract_data:70 | ðŸ”„ Trying Stooq (Polish Exchange)...
2025-09-22 00:01:45 | INFO | src.data_ingestion.completely_free_stock_data:_extract_from_stooq:145 | Stooq total: 1992 records
2025-09-22 00:01:45 | INFO | src.data_ingestion.completely_free_stock_data:extract_data:75 | âœ… Stooq (Polish Exchange) succeeded: 1992 records
2025-09-22 00:01:45 | INFO | src.data_ingestion.base_ingestion:run_ingestion:145 | Extracted 1992 records
2025-09-22 00:01:45 | INFO | src.data_ingestion.base_ingestion:run_ingestion:153 | Transforming data...
2025-09-22 00:01:45 | INFO | src.data_ingestion.completely_free_stock_data:transform_data:305 | Transforming completely free stock data...
2025-09-22 00:01:45 | INFO | src.data_ingestion.base_ingestion:validate_stock_data:203 | Validating stock data quality...
2025-09-22 00:01:45 | INFO | src.data_ingestion.base_ingestion:validate_stock_data:230 | Data quality validation: 0 records removed, 1992 records retained
2025-09-22 00:01:45 | INFO | src.data_ingestion.completely_free_stock_data:transform_data:340 | Transformation complete: 1992 clean records
2025-09-22 00:01:45 | INFO | src.data_ingestion.base_ingestion:run_ingestion:155 | Transformed data: 1992 records
2025-09-22 00:01:45 | INFO | src.data_ingestion.base_ingestion:run_ingestion:158 | Loading data into database...
2025-09-22 00:01:45 | INFO | src.data_ingestion.completely_free_stock_data:load_data:345 | Loading completely free stock data...
2025-09-22 00:01:45 | ERROR | src.models.database:get_session:165 | Database session error: (psycopg2.errors.CheckViolation) no partition of relation "stock_prices" found for row
DETAIL:  Partition key of the failing row contains (date) = (2025-01-02).

[SQL: INSERT INTO stock_prices (ticker, date, open_price, high_price, low_price, close_price, adj_close_price, volume, dividends, stock_splits, data_source, created_at) VALUES (%(ticker__0)s, %(date__0)s, %(open_price__0)s, %(high_price__0)s, %(low_price__ ... 121998 characters truncated ... volume__499)s, %(dividends__499)s, %(stock_splits__499)s, %(data_source__499)s, %(created_at__499)s)]
[parameters: {'ticker__0': 'AAPL', 'high_price__0': 228.946, 'adj_close_price__0': 225.973, 'close_price__0': 225.973, 'data_source__0': 'yfinance', 'low_price__0': 225.314, 'stock_splits__0': 0.0, 'created_at__0': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__0': 226.841, 'dividends__0': 0.0, 'date__0': datetime.date(2024, 9, 23), 'volume__0': 54265192.0, 'ticker__1': 'AAPL', 'high_price__1': 228.846, 'adj_close_price__1': 226.871, 'close_price__1': 226.871, 'data_source__1': 'yfinance', 'low_price__1': 225.234, 'stock_splits__1': 0.0, 'created_at__1': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__1': 228.143, 'dividends__1': 0.0, 'date__1': datetime.date(2024, 9, 24), 'volume__1': 43651930.0, 'ticker__2': 'AAPL', 'high_price__2': 226.791, 'adj_close_price__2': 225.873, 'close_price__2': 225.873, 'data_source__2': 'yfinance', 'low_price__2': 223.528, 'stock_splits__2': 0.0, 'created_at__2': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__2': 224.436, 'dividends__2': 0.0, 'date__2': datetime.date(2024, 9, 25), 'volume__2': 42401832.0, 'ticker__3': 'AAPL', 'high_price__3': 227.998, 'adj_close_price__3': 227.02, 'close_price__3': 227.02, 'data_source__3': 'yfinance', 'low_price__3': 224.915, 'stock_splits__3': 0.0, 'created_at__3': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__3': 226.801, 'dividends__3': 0.0, 'date__3': datetime.date(2024, 9, 26), 'volume__3': 36717340.0, 'ticker__4': 'AAPL', 'high_price__4': 229.016 ... 5900 parameters truncated ... 'date__495': datetime.date(2025, 9, 17), 'volume__495': 15816585.0, 'ticker__496': 'MSFT', 'high_price__496': 513.07, 'adj_close_price__496': 508.45, 'close_price__496': 508.45, 'data_source__496': 'yfinance', 'low_price__496': 507.66, 'stock_splits__496': 0.0, 'created_at__496': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__496': 511.49, 'dividends__496': 0.0, 'date__496': datetime.date(2025, 9, 18), 'volume__496': 18913696.0, 'ticker__497': 'MSFT', 'high_price__497': 519.3, 'adj_close_price__497': 517.93, 'close_price__497': 517.93, 'data_source__497': 'yfinance', 'low_price__497': 510.31, 'stock_splits__497': 0.0, 'created_at__497': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__497': 510.56, 'dividends__497': 0.0, 'date__497': datetime.date(2025, 9, 19), 'volume__497': 52474093.0, 'ticker__498': 'GOOGL', 'high_price__498': 165.301, 'adj_close_price__498': 161.665, 'close_price__498': 161.665, 'data_source__498': 'yfinance', 'low_price__498': 161.485, 'stock_splits__498': 0.0, 'created_at__498': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__498': 164.162, 'dividends__498': 0.0, 'date__498': datetime.date(2024, 9, 23), 'volume__498': 24178530.0, 'ticker__499': 'GOOGL', 'high_price__499': 163.029, 'adj_close_price__499': 162.104, 'close_price__499': 162.104, 'data_source__499': 'yfinance', 'low_price__499': 160.506, 'stock_splits__499': 0.0, 'created_at__499': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__499': 162.843, 'dividends__499': 0.0, 'date__499': datetime.date(2024, 9, 24), 'volume__499': 23358887.0}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-22 00:01:45 | ERROR | src.data_ingestion.completely_free_stock_data:load_data:384 | Batch 1 failed: (psycopg2.errors.CheckViolation) no partition of relation "stock_prices" found for row
DETAIL:  Partition key of the failing row contains (date) = (2025-01-02).

[SQL: INSERT INTO stock_prices (ticker, date, open_price, high_price, low_price, close_price, adj_close_price, volume, dividends, stock_splits, data_source, created_at) VALUES (%(ticker__0)s, %(date__0)s, %(open_price__0)s, %(high_price__0)s, %(low_price__ ... 121998 characters truncated ... volume__499)s, %(dividends__499)s, %(stock_splits__499)s, %(data_source__499)s, %(created_at__499)s)]
[parameters: {'ticker__0': 'AAPL', 'high_price__0': 228.946, 'adj_close_price__0': 225.973, 'close_price__0': 225.973, 'data_source__0': 'yfinance', 'low_price__0': 225.314, 'stock_splits__0': 0.0, 'created_at__0': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__0': 226.841, 'dividends__0': 0.0, 'date__0': datetime.date(2024, 9, 23), 'volume__0': 54265192.0, 'ticker__1': 'AAPL', 'high_price__1': 228.846, 'adj_close_price__1': 226.871, 'close_price__1': 226.871, 'data_source__1': 'yfinance', 'low_price__1': 225.234, 'stock_splits__1': 0.0, 'created_at__1': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__1': 228.143, 'dividends__1': 0.0, 'date__1': datetime.date(2024, 9, 24), 'volume__1': 43651930.0, 'ticker__2': 'AAPL', 'high_price__2': 226.791, 'adj_close_price__2': 225.873, 'close_price__2': 225.873, 'data_source__2': 'yfinance', 'low_price__2': 223.528, 'stock_splits__2': 0.0, 'created_at__2': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__2': 224.436, 'dividends__2': 0.0, 'date__2': datetime.date(2024, 9, 25), 'volume__2': 42401832.0, 'ticker__3': 'AAPL', 'high_price__3': 227.998, 'adj_close_price__3': 227.02, 'close_price__3': 227.02, 'data_source__3': 'yfinance', 'low_price__3': 224.915, 'stock_splits__3': 0.0, 'created_at__3': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__3': 226.801, 'dividends__3': 0.0, 'date__3': datetime.date(2024, 9, 26), 'volume__3': 36717340.0, 'ticker__4': 'AAPL', 'high_price__4': 229.016 ... 5900 parameters truncated ... 'date__495': datetime.date(2025, 9, 17), 'volume__495': 15816585.0, 'ticker__496': 'MSFT', 'high_price__496': 513.07, 'adj_close_price__496': 508.45, 'close_price__496': 508.45, 'data_source__496': 'yfinance', 'low_price__496': 507.66, 'stock_splits__496': 0.0, 'created_at__496': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__496': 511.49, 'dividends__496': 0.0, 'date__496': datetime.date(2025, 9, 18), 'volume__496': 18913696.0, 'ticker__497': 'MSFT', 'high_price__497': 519.3, 'adj_close_price__497': 517.93, 'close_price__497': 517.93, 'data_source__497': 'yfinance', 'low_price__497': 510.31, 'stock_splits__497': 0.0, 'created_at__497': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__497': 510.56, 'dividends__497': 0.0, 'date__497': datetime.date(2025, 9, 19), 'volume__497': 52474093.0, 'ticker__498': 'GOOGL', 'high_price__498': 165.301, 'adj_close_price__498': 161.665, 'close_price__498': 161.665, 'data_source__498': 'yfinance', 'low_price__498': 161.485, 'stock_splits__498': 0.0, 'created_at__498': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__498': 164.162, 'dividends__498': 0.0, 'date__498': datetime.date(2024, 9, 23), 'volume__498': 24178530.0, 'ticker__499': 'GOOGL', 'high_price__499': 163.029, 'adj_close_price__499': 162.104, 'close_price__499': 162.104, 'data_source__499': 'yfinance', 'low_price__499': 160.506, 'stock_splits__499': 0.0, 'created_at__499': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__499': 162.843, 'dividends__499': 0.0, 'date__499': datetime.date(2024, 9, 24), 'volume__499': 23358887.0}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-22 00:01:45 | ERROR | src.models.database:get_session:165 | Database session error: (psycopg2.errors.CheckViolation) no partition of relation "stock_prices" found for row
DETAIL:  Partition key of the failing row contains (date) = (2025-01-02).

[SQL: INSERT INTO stock_prices (ticker, date, open_price, high_price, low_price, close_price, adj_close_price, volume, dividends, stock_splits, data_source, created_at) VALUES (%(ticker__0)s, %(date__0)s, %(open_price__0)s, %(high_price__0)s, %(low_price__ ... 121998 characters truncated ... volume__499)s, %(dividends__499)s, %(stock_splits__499)s, %(data_source__499)s, %(created_at__499)s)]
[parameters: {'ticker__0': 'GOOGL', 'high_price__0': 162.624, 'adj_close_price__0': 161.305, 'close_price__0': 161.305, 'data_source__0': 'yfinance', 'low_price__0': 161.115, 'stock_splits__0': 0.0, 'created_at__0': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__0': 161.285, 'dividends__0': 0.0, 'date__0': datetime.date(2024, 9, 25), 'volume__0': 18890824.0, 'ticker__1': 'GOOGL', 'high_price__1': 163.892, 'adj_close_price__1': 162.544, 'close_price__1': 162.544, 'data_source__1': 'yfinance', 'low_price__1': 162.094, 'stock_splits__1': 0.0, 'created_at__1': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__1': 163.453, 'dividends__1': 0.0, 'date__1': datetime.date(2024, 9, 26), 'volume__1': 20342623.0, 'ticker__2': 'GOOGL', 'high_price__2': 165.51, 'adj_close_price__2': 163.762, 'close_price__2': 163.762, 'data_source__2': 'yfinance', 'low_price__2': 162.44, 'stock_splits__2': 0.0, 'created_at__2': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__2': 162.624, 'dividends__2': 0.0, 'date__2': datetime.date(2024, 9, 27), 'volume__2': 21125490.0, 'ticker__3': 'GOOGL', 'high_price__3': 165.96, 'adj_close_price__3': 165.66, 'close_price__3': 165.66, 'data_source__3': 'yfinance', 'low_price__3': 163.073, 'stock_splits__3': 0.0, 'created_at__3': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__3': 163.133, 'dividends__3': 0.0, 'date__3': datetime.date(2024, 9, 30), 'volume__3': 20504775.0, 'ticker__4': 'GOOGL', 'high_price__4': 168.966 ... 5900 parameters truncated ... 'date__495': datetime.date(2025, 9, 19), 'volume__495': 97943172.0, 'ticker__496': 'TSLA', 'high_price__496': 250.0, 'adj_close_price__496': 250.0, 'close_price__496': 250.0, 'data_source__496': 'yfinance', 'low_price__496': 241.92, 'stock_splits__496': 0.0, 'created_at__496': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__496': 242.61, 'dividends__496': 0.0, 'date__496': datetime.date(2024, 9, 23), 'volume__496': 86927194.0, 'ticker__497': 'TSLA', 'high_price__497': 257.19, 'adj_close_price__497': 254.27, 'close_price__497': 254.27, 'data_source__497': 'yfinance', 'low_price__497': 249.0501, 'stock_splits__497': 0.0, 'created_at__497': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__497': 254.08, 'dividends__497': 0.0, 'date__497': datetime.date(2024, 9, 24), 'volume__497': 88490999.0, 'ticker__498': 'TSLA', 'high_price__498': 257.05, 'adj_close_price__498': 257.02, 'close_price__498': 257.02, 'data_source__498': 'yfinance', 'low_price__498': 252.28, 'stock_splits__498': 0.0, 'created_at__498': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__498': 252.54, 'dividends__498': 0.0, 'date__498': datetime.date(2024, 9, 25), 'volume__498': 65034318.0, 'ticker__499': 'TSLA', 'high_price__499': 261.75, 'adj_close_price__499': 254.22, 'close_price__499': 254.22, 'data_source__499': 'yfinance', 'low_price__499': 251.53, 'stock_splits__499': 0.0, 'created_at__499': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__499': 260.6, 'dividends__499': 0.0, 'date__499': datetime.date(2024, 9, 26), 'volume__499': 67142193.0}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-22 00:01:45 | ERROR | src.data_ingestion.completely_free_stock_data:load_data:384 | Batch 2 failed: (psycopg2.errors.CheckViolation) no partition of relation "stock_prices" found for row
DETAIL:  Partition key of the failing row contains (date) = (2025-01-02).

[SQL: INSERT INTO stock_prices (ticker, date, open_price, high_price, low_price, close_price, adj_close_price, volume, dividends, stock_splits, data_source, created_at) VALUES (%(ticker__0)s, %(date__0)s, %(open_price__0)s, %(high_price__0)s, %(low_price__ ... 121998 characters truncated ... volume__499)s, %(dividends__499)s, %(stock_splits__499)s, %(data_source__499)s, %(created_at__499)s)]
[parameters: {'ticker__0': 'GOOGL', 'high_price__0': 162.624, 'adj_close_price__0': 161.305, 'close_price__0': 161.305, 'data_source__0': 'yfinance', 'low_price__0': 161.115, 'stock_splits__0': 0.0, 'created_at__0': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__0': 161.285, 'dividends__0': 0.0, 'date__0': datetime.date(2024, 9, 25), 'volume__0': 18890824.0, 'ticker__1': 'GOOGL', 'high_price__1': 163.892, 'adj_close_price__1': 162.544, 'close_price__1': 162.544, 'data_source__1': 'yfinance', 'low_price__1': 162.094, 'stock_splits__1': 0.0, 'created_at__1': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__1': 163.453, 'dividends__1': 0.0, 'date__1': datetime.date(2024, 9, 26), 'volume__1': 20342623.0, 'ticker__2': 'GOOGL', 'high_price__2': 165.51, 'adj_close_price__2': 163.762, 'close_price__2': 163.762, 'data_source__2': 'yfinance', 'low_price__2': 162.44, 'stock_splits__2': 0.0, 'created_at__2': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__2': 162.624, 'dividends__2': 0.0, 'date__2': datetime.date(2024, 9, 27), 'volume__2': 21125490.0, 'ticker__3': 'GOOGL', 'high_price__3': 165.96, 'adj_close_price__3': 165.66, 'close_price__3': 165.66, 'data_source__3': 'yfinance', 'low_price__3': 163.073, 'stock_splits__3': 0.0, 'created_at__3': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__3': 163.133, 'dividends__3': 0.0, 'date__3': datetime.date(2024, 9, 30), 'volume__3': 20504775.0, 'ticker__4': 'GOOGL', 'high_price__4': 168.966 ... 5900 parameters truncated ... 'date__495': datetime.date(2025, 9, 19), 'volume__495': 97943172.0, 'ticker__496': 'TSLA', 'high_price__496': 250.0, 'adj_close_price__496': 250.0, 'close_price__496': 250.0, 'data_source__496': 'yfinance', 'low_price__496': 241.92, 'stock_splits__496': 0.0, 'created_at__496': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__496': 242.61, 'dividends__496': 0.0, 'date__496': datetime.date(2024, 9, 23), 'volume__496': 86927194.0, 'ticker__497': 'TSLA', 'high_price__497': 257.19, 'adj_close_price__497': 254.27, 'close_price__497': 254.27, 'data_source__497': 'yfinance', 'low_price__497': 249.0501, 'stock_splits__497': 0.0, 'created_at__497': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__497': 254.08, 'dividends__497': 0.0, 'date__497': datetime.date(2024, 9, 24), 'volume__497': 88490999.0, 'ticker__498': 'TSLA', 'high_price__498': 257.05, 'adj_close_price__498': 257.02, 'close_price__498': 257.02, 'data_source__498': 'yfinance', 'low_price__498': 252.28, 'stock_splits__498': 0.0, 'created_at__498': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__498': 252.54, 'dividends__498': 0.0, 'date__498': datetime.date(2024, 9, 25), 'volume__498': 65034318.0, 'ticker__499': 'TSLA', 'high_price__499': 261.75, 'adj_close_price__499': 254.22, 'close_price__499': 254.22, 'data_source__499': 'yfinance', 'low_price__499': 251.53, 'stock_splits__499': 0.0, 'created_at__499': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__499': 260.6, 'dividends__499': 0.0, 'date__499': datetime.date(2024, 9, 26), 'volume__499': 67142193.0}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-22 00:01:46 | ERROR | src.models.database:get_session:165 | Database session error: (psycopg2.errors.CheckViolation) no partition of relation "stock_prices" found for row
DETAIL:  Partition key of the failing row contains (date) = (2025-01-02).

[SQL: INSERT INTO stock_prices (ticker, date, open_price, high_price, low_price, close_price, adj_close_price, volume, dividends, stock_splits, data_source, created_at) VALUES (%(ticker__0)s, %(date__0)s, %(open_price__0)s, %(high_price__0)s, %(low_price__ ... 121998 characters truncated ... volume__499)s, %(dividends__499)s, %(stock_splits__499)s, %(data_source__499)s, %(created_at__499)s)]
[parameters: {'ticker__0': 'TSLA', 'high_price__0': 260.6999, 'adj_close_price__0': 260.46, 'close_price__0': 260.46, 'data_source__0': 'yfinance', 'low_price__0': 254.12, 'stock_splits__0': 0.0, 'created_at__0': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__0': 257.375, 'dividends__0': 0.0, 'date__0': datetime.date(2024, 9, 27), 'volume__0': 70988067.0, 'ticker__1': 'TSLA', 'high_price__1': 264.86, 'adj_close_price__1': 261.63, 'close_price__1': 261.63, 'data_source__1': 'yfinance', 'low_price__1': 255.77, 'stock_splits__1': 0.0, 'created_at__1': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__1': 259.04, 'dividends__1': 0.0, 'date__1': datetime.date(2024, 9, 30), 'volume__1': 80873381.0, 'ticker__2': 'TSLA', 'high_price__2': 263.98, 'adj_close_price__2': 258.02, 'close_price__2': 258.02, 'data_source__2': 'yfinance', 'low_price__2': 248.53, 'stock_splits__2': 0.0, 'created_at__2': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__2': 262.67, 'dividends__2': 0.0, 'date__2': datetime.date(2024, 10, 1), 'volume__2': 87397613.0, 'ticker__3': 'TSLA', 'high_price__3': 251.1585, 'adj_close_price__3': 249.02, 'close_price__3': 249.02, 'data_source__3': 'yfinance', 'low_price__3': 241.5, 'stock_splits__3': 0.0, 'created_at__3': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__3': 247.55, 'dividends__3': 0.0, 'date__3': datetime.date(2024, 10, 2), 'volume__3': 93983930.0, 'ticker__4': 'TSLA', 'high_price__4': 249.79 ... 5900 parameters truncated ... 'date__495': datetime.date(2024, 9, 24), 'volume__495': 12992956.0, 'ticker__496': 'META', 'high_price__496': 576.88, 'adj_close_price__496': 568.31, 'close_price__496': 568.31, 'data_source__496': 'yfinance', 'low_price__496': 563.72, 'stock_splits__496': 0.0, 'created_at__496': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__496': 564.05, 'dividends__496': 0.0, 'date__496': datetime.date(2024, 9, 25), 'volume__496': 16543350.0, 'ticker__497': 'META', 'high_price__497': 577.4, 'adj_close_price__497': 567.84, 'close_price__497': 567.84, 'data_source__497': 'yfinance', 'low_price__497': 562.3501, 'stock_splits__497': 0.0, 'created_at__497': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__497': 575.73, 'dividends__497': 0.0, 'date__497': datetime.date(2024, 9, 26), 'volume__497': 14400787.0, 'ticker__498': 'META', 'high_price__498': 570.8399, 'adj_close_price__498': 567.36, 'close_price__498': 567.36, 'data_source__498': 'yfinance', 'low_price__498': 564.51, 'stock_splits__498': 0.0, 'created_at__498': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__498': 570.1, 'dividends__498': 0.0, 'date__498': datetime.date(2024, 9, 27), 'volume__498': 9398367.0, 'ticker__499': 'META', 'high_price__499': 574.68, 'adj_close_price__499': 572.44, 'close_price__499': 572.44, 'data_source__499': 'yfinance', 'low_price__499': 564.8, 'stock_splits__499': 0.0, 'created_at__499': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__499': 567.7, 'dividends__499': 0.0, 'date__499': datetime.date(2024, 9, 30), 'volume__499': 12807206.0}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-22 00:01:46 | ERROR | src.data_ingestion.completely_free_stock_data:load_data:384 | Batch 3 failed: (psycopg2.errors.CheckViolation) no partition of relation "stock_prices" found for row
DETAIL:  Partition key of the failing row contains (date) = (2025-01-02).

[SQL: INSERT INTO stock_prices (ticker, date, open_price, high_price, low_price, close_price, adj_close_price, volume, dividends, stock_splits, data_source, created_at) VALUES (%(ticker__0)s, %(date__0)s, %(open_price__0)s, %(high_price__0)s, %(low_price__ ... 121998 characters truncated ... volume__499)s, %(dividends__499)s, %(stock_splits__499)s, %(data_source__499)s, %(created_at__499)s)]
[parameters: {'ticker__0': 'TSLA', 'high_price__0': 260.6999, 'adj_close_price__0': 260.46, 'close_price__0': 260.46, 'data_source__0': 'yfinance', 'low_price__0': 254.12, 'stock_splits__0': 0.0, 'created_at__0': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__0': 257.375, 'dividends__0': 0.0, 'date__0': datetime.date(2024, 9, 27), 'volume__0': 70988067.0, 'ticker__1': 'TSLA', 'high_price__1': 264.86, 'adj_close_price__1': 261.63, 'close_price__1': 261.63, 'data_source__1': 'yfinance', 'low_price__1': 255.77, 'stock_splits__1': 0.0, 'created_at__1': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__1': 259.04, 'dividends__1': 0.0, 'date__1': datetime.date(2024, 9, 30), 'volume__1': 80873381.0, 'ticker__2': 'TSLA', 'high_price__2': 263.98, 'adj_close_price__2': 258.02, 'close_price__2': 258.02, 'data_source__2': 'yfinance', 'low_price__2': 248.53, 'stock_splits__2': 0.0, 'created_at__2': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__2': 262.67, 'dividends__2': 0.0, 'date__2': datetime.date(2024, 10, 1), 'volume__2': 87397613.0, 'ticker__3': 'TSLA', 'high_price__3': 251.1585, 'adj_close_price__3': 249.02, 'close_price__3': 249.02, 'data_source__3': 'yfinance', 'low_price__3': 241.5, 'stock_splits__3': 0.0, 'created_at__3': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__3': 247.55, 'dividends__3': 0.0, 'date__3': datetime.date(2024, 10, 2), 'volume__3': 93983930.0, 'ticker__4': 'TSLA', 'high_price__4': 249.79 ... 5900 parameters truncated ... 'date__495': datetime.date(2024, 9, 24), 'volume__495': 12992956.0, 'ticker__496': 'META', 'high_price__496': 576.88, 'adj_close_price__496': 568.31, 'close_price__496': 568.31, 'data_source__496': 'yfinance', 'low_price__496': 563.72, 'stock_splits__496': 0.0, 'created_at__496': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__496': 564.05, 'dividends__496': 0.0, 'date__496': datetime.date(2024, 9, 25), 'volume__496': 16543350.0, 'ticker__497': 'META', 'high_price__497': 577.4, 'adj_close_price__497': 567.84, 'close_price__497': 567.84, 'data_source__497': 'yfinance', 'low_price__497': 562.3501, 'stock_splits__497': 0.0, 'created_at__497': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__497': 575.73, 'dividends__497': 0.0, 'date__497': datetime.date(2024, 9, 26), 'volume__497': 14400787.0, 'ticker__498': 'META', 'high_price__498': 570.8399, 'adj_close_price__498': 567.36, 'close_price__498': 567.36, 'data_source__498': 'yfinance', 'low_price__498': 564.51, 'stock_splits__498': 0.0, 'created_at__498': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__498': 570.1, 'dividends__498': 0.0, 'date__498': datetime.date(2024, 9, 27), 'volume__498': 9398367.0, 'ticker__499': 'META', 'high_price__499': 574.68, 'adj_close_price__499': 572.44, 'close_price__499': 572.44, 'data_source__499': 'yfinance', 'low_price__499': 564.8, 'stock_splits__499': 0.0, 'created_at__499': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__499': 567.7, 'dividends__499': 0.0, 'date__499': datetime.date(2024, 9, 30), 'volume__499': 12807206.0}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-22 00:01:46 | ERROR | src.models.database:get_session:165 | Database session error: (psycopg2.errors.CheckViolation) no partition of relation "stock_prices" found for row
DETAIL:  Partition key of the failing row contains (date) = (2025-01-02).

[SQL: INSERT INTO stock_prices (ticker, date, open_price, high_price, low_price, close_price, adj_close_price, volume, dividends, stock_splits, data_source, created_at) VALUES (%(ticker__0)s, %(date__0)s, %(open_price__0)s, %(high_price__0)s, %(low_price__ ... 120022 characters truncated ... volume__491)s, %(dividends__491)s, %(stock_splits__491)s, %(data_source__491)s, %(created_at__491)s)]
[parameters: {'ticker__0': 'META', 'high_price__0': 583.04, 'adj_close_price__0': 576.47, 'close_price__0': 576.47, 'data_source__0': 'yfinance', 'low_price__0': 570.1, 'stock_splits__0': 0.0, 'created_at__0': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__0': 577.98, 'dividends__0': 0.0, 'date__0': datetime.date(2024, 10, 1), 'volume__0': 15259274.0, 'ticker__1': 'META', 'high_price__1': 576.0, 'adj_close_price__1': 572.81, 'close_price__1': 572.81, 'data_source__1': 'yfinance', 'low_price__1': 569.34, 'stock_splits__1': 0.0, 'created_at__1': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__1': 574.86, 'dividends__1': 0.0, 'date__1': datetime.date(2024, 10, 2), 'volume__1': 6524650.0, 'ticker__2': 'META', 'high_price__2': 583.36, 'adj_close_price__2': 582.77, 'close_price__2': 582.77, 'data_source__2': 'yfinance', 'low_price__2': 568.73, 'stock_splits__2': 0.0, 'created_at__2': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__2': 570.15, 'dividends__2': 0.0, 'date__2': datetime.date(2024, 10, 3), 'volume__2': 11580980.0, 'ticker__3': 'META', 'high_price__3': 596.85, 'adj_close_price__3': 595.94, 'close_price__3': 595.94, 'data_source__3': 'yfinance', 'low_price__3': 581.43, 'stock_splits__3': 0.0, 'created_at__3': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__3': 583.73, 'dividends__3': 0.0, 'date__3': datetime.date(2024, 10, 4), 'volume__3': 14199788.0, 'ticker__4': 'META', 'high_price__4': 602.95 ... 5804 parameters truncated ... 'date__487': datetime.date(2025, 9, 15), 'volume__487': 2909277.0, 'ticker__488': 'NFLX', 'high_price__488': 1208.9999, 'adj_close_price__488': 1200.51, 'close_price__488': 1200.51, 'data_source__488': 'yfinance', 'low_price__488': 1197.28, 'stock_splits__488': 0.0, 'created_at__488': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__488': 1205.64, 'dividends__488': 0.0, 'date__488': datetime.date(2025, 9, 16), 'volume__488': 2404686.0, 'ticker__489': 'NFLX', 'high_price__489': 1233.93, 'adj_close_price__489': 1228.5, 'close_price__489': 1228.5, 'data_source__489': 'yfinance', 'low_price__489': 1206.605, 'stock_splits__489': 0.0, 'created_at__489': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__489': 1221.02, 'dividends__489': 0.0, 'date__489': datetime.date(2025, 9, 17), 'volume__489': 3459796.0, 'ticker__490': 'NFLX', 'high_price__490': 1233.0, 'adj_close_price__490': 1207.78, 'close_price__490': 1207.78, 'data_source__490': 'yfinance', 'low_price__490': 1205.5, 'stock_splits__490': 0.0, 'created_at__490': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__490': 1220.82, 'dividends__490': 0.0, 'date__490': datetime.date(2025, 9, 18), 'volume__490': 3169105.0, 'ticker__491': 'NFLX', 'high_price__491': 1229.9499, 'adj_close_price__491': 1226.97, 'close_price__491': 1226.97, 'data_source__491': 'yfinance', 'low_price__491': 1208.1, 'stock_splits__491': 0.0, 'created_at__491': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__491': 1218.62, 'dividends__491': 0.0, 'date__491': datetime.date(2025, 9, 19), 'volume__491': 4947590.0}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-22 00:01:46 | ERROR | src.data_ingestion.completely_free_stock_data:load_data:384 | Batch 4 failed: (psycopg2.errors.CheckViolation) no partition of relation "stock_prices" found for row
DETAIL:  Partition key of the failing row contains (date) = (2025-01-02).

[SQL: INSERT INTO stock_prices (ticker, date, open_price, high_price, low_price, close_price, adj_close_price, volume, dividends, stock_splits, data_source, created_at) VALUES (%(ticker__0)s, %(date__0)s, %(open_price__0)s, %(high_price__0)s, %(low_price__ ... 120022 characters truncated ... volume__491)s, %(dividends__491)s, %(stock_splits__491)s, %(data_source__491)s, %(created_at__491)s)]
[parameters: {'ticker__0': 'META', 'high_price__0': 583.04, 'adj_close_price__0': 576.47, 'close_price__0': 576.47, 'data_source__0': 'yfinance', 'low_price__0': 570.1, 'stock_splits__0': 0.0, 'created_at__0': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__0': 577.98, 'dividends__0': 0.0, 'date__0': datetime.date(2024, 10, 1), 'volume__0': 15259274.0, 'ticker__1': 'META', 'high_price__1': 576.0, 'adj_close_price__1': 572.81, 'close_price__1': 572.81, 'data_source__1': 'yfinance', 'low_price__1': 569.34, 'stock_splits__1': 0.0, 'created_at__1': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__1': 574.86, 'dividends__1': 0.0, 'date__1': datetime.date(2024, 10, 2), 'volume__1': 6524650.0, 'ticker__2': 'META', 'high_price__2': 583.36, 'adj_close_price__2': 582.77, 'close_price__2': 582.77, 'data_source__2': 'yfinance', 'low_price__2': 568.73, 'stock_splits__2': 0.0, 'created_at__2': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__2': 570.15, 'dividends__2': 0.0, 'date__2': datetime.date(2024, 10, 3), 'volume__2': 11580980.0, 'ticker__3': 'META', 'high_price__3': 596.85, 'adj_close_price__3': 595.94, 'close_price__3': 595.94, 'data_source__3': 'yfinance', 'low_price__3': 581.43, 'stock_splits__3': 0.0, 'created_at__3': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__3': 583.73, 'dividends__3': 0.0, 'date__3': datetime.date(2024, 10, 4), 'volume__3': 14199788.0, 'ticker__4': 'META', 'high_price__4': 602.95 ... 5804 parameters truncated ... 'date__487': datetime.date(2025, 9, 15), 'volume__487': 2909277.0, 'ticker__488': 'NFLX', 'high_price__488': 1208.9999, 'adj_close_price__488': 1200.51, 'close_price__488': 1200.51, 'data_source__488': 'yfinance', 'low_price__488': 1197.28, 'stock_splits__488': 0.0, 'created_at__488': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__488': 1205.64, 'dividends__488': 0.0, 'date__488': datetime.date(2025, 9, 16), 'volume__488': 2404686.0, 'ticker__489': 'NFLX', 'high_price__489': 1233.93, 'adj_close_price__489': 1228.5, 'close_price__489': 1228.5, 'data_source__489': 'yfinance', 'low_price__489': 1206.605, 'stock_splits__489': 0.0, 'created_at__489': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__489': 1221.02, 'dividends__489': 0.0, 'date__489': datetime.date(2025, 9, 17), 'volume__489': 3459796.0, 'ticker__490': 'NFLX', 'high_price__490': 1233.0, 'adj_close_price__490': 1207.78, 'close_price__490': 1207.78, 'data_source__490': 'yfinance', 'low_price__490': 1205.5, 'stock_splits__490': 0.0, 'created_at__490': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__490': 1220.82, 'dividends__490': 0.0, 'date__490': datetime.date(2025, 9, 18), 'volume__490': 3169105.0, 'ticker__491': 'NFLX', 'high_price__491': 1229.9499, 'adj_close_price__491': 1226.97, 'close_price__491': 1226.97, 'data_source__491': 'yfinance', 'low_price__491': 1208.1, 'stock_splits__491': 0.0, 'created_at__491': Timestamp('2025-09-21 23:01:45.404161'), 'open_price__491': 1218.62, 'dividends__491': 0.0, 'date__491': datetime.date(2025, 9, 19), 'volume__491': 4947590.0}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-22 00:01:46 | INFO | src.data_ingestion.completely_free_stock_data:load_data:387 | Load complete: 1992 inserted, 1992 failed
2025-09-22 00:01:46 | INFO | src.data_ingestion.base_ingestion:run_ingestion:178 | Ingestion completed: 1992 inserted, 0 updated, 1992 failed
2025-09-22 22:13:15 | INFO | src.data_ingestion.base_ingestion:run_ingestion:139 | Starting ingestion job: completely_free_stock_data
2025-09-22 22:13:15 | INFO | src.data_ingestion.base_ingestion:run_ingestion:142 | Extracting data...
2025-09-22 22:13:15 | INFO | src.data_ingestion.completely_free_stock_data:extract_data:59 | Extracting 100% free data for 10 tickers from 2024-09-22 22:13:15.336124 to 2025-09-22 22:13:15.336124
2025-09-22 22:13:15 | INFO | src.data_ingestion.completely_free_stock_data:extract_data:70 | ðŸ”„ Trying Stooq (Polish Exchange)...
2025-09-22 22:13:27 | INFO | src.data_ingestion.completely_free_stock_data:_extract_from_stooq:145 | Stooq total: 2000 records
2025-09-22 22:13:27 | INFO | src.data_ingestion.completely_free_stock_data:extract_data:75 | âœ… Stooq (Polish Exchange) succeeded: 2000 records
2025-09-22 22:13:27 | INFO | src.data_ingestion.base_ingestion:run_ingestion:145 | Extracted 2000 records
2025-09-22 22:13:27 | INFO | src.data_ingestion.base_ingestion:run_ingestion:153 | Transforming data...
2025-09-22 22:13:27 | INFO | src.data_ingestion.completely_free_stock_data:transform_data:305 | Transforming completely free stock data...
2025-09-22 22:13:27 | INFO | src.data_ingestion.base_ingestion:validate_stock_data:203 | Validating stock data quality...
2025-09-22 22:13:27 | INFO | src.data_ingestion.base_ingestion:validate_stock_data:230 | Data quality validation: 0 records removed, 2000 records retained
2025-09-22 22:13:27 | INFO | src.data_ingestion.completely_free_stock_data:transform_data:340 | Transformation complete: 2000 clean records
2025-09-22 22:13:27 | INFO | src.data_ingestion.base_ingestion:run_ingestion:155 | Transformed data: 2000 records
2025-09-22 22:13:27 | INFO | src.data_ingestion.base_ingestion:run_ingestion:158 | Loading data into database...
2025-09-22 22:13:27 | INFO | src.data_ingestion.completely_free_stock_data:load_data:345 | Loading completely free stock data...
2025-09-22 22:13:28 | ERROR | src.models.database:get_session:165 | Database session error: (psycopg2.errors.CheckViolation) no partition of relation "stock_prices" found for row
DETAIL:  Partition key of the failing row contains (date) = (2025-01-02).

[SQL: INSERT INTO stock_prices (ticker, date, open_price, high_price, low_price, close_price, adj_close_price, volume, dividends, stock_splits, data_source, created_at) VALUES (%(ticker__0)s, %(date__0)s, %(open_price__0)s, %(high_price__0)s, %(low_price__ ... 121998 characters truncated ... volume__499)s, %(dividends__499)s, %(stock_splits__499)s, %(data_source__499)s, %(created_at__499)s)]
[parameters: {'ticker__0': 'AAPL', 'high_price__0': 228.946, 'adj_close_price__0': 225.973, 'open_price__0': 226.841, 'stock_splits__0': 0.0, 'close_price__0': 225.973, 'data_source__0': 'yfinance', 'dividends__0': 0.0, 'volume__0': 54265192.0, 'low_price__0': 225.314, 'created_at__0': Timestamp('2025-09-22 21:13:27.918675'), 'date__0': datetime.date(2024, 9, 23), 'ticker__1': 'AAPL', 'high_price__1': 228.846, 'adj_close_price__1': 226.871, 'open_price__1': 228.143, 'stock_splits__1': 0.0, 'close_price__1': 226.871, 'data_source__1': 'yfinance', 'dividends__1': 0.0, 'volume__1': 43651930.0, 'low_price__1': 225.234, 'created_at__1': Timestamp('2025-09-22 21:13:27.918675'), 'date__1': datetime.date(2024, 9, 24), 'ticker__2': 'AAPL', 'high_price__2': 226.791, 'adj_close_price__2': 225.873, 'open_price__2': 224.436, 'stock_splits__2': 0.0, 'close_price__2': 225.873, 'data_source__2': 'yfinance', 'dividends__2': 0.0, 'volume__2': 42401832.0, 'low_price__2': 223.528, 'created_at__2': Timestamp('2025-09-22 21:13:27.918675'), 'date__2': datetime.date(2024, 9, 25), 'ticker__3': 'AAPL', 'high_price__3': 227.998, 'adj_close_price__3': 227.02, 'open_price__3': 226.801, 'stock_splits__3': 0.0, 'close_price__3': 227.02, 'data_source__3': 'yfinance', 'dividends__3': 0.0, 'volume__3': 36717340.0, 'low_price__3': 224.915, 'created_at__3': Timestamp('2025-09-22 21:13:27.918675'), 'date__3': datetime.date(2024, 9, 26), 'ticker__4': 'AAPL', 'high_price__4': 229.016 ... 5900 parameters truncated ... 'created_at__495': Timestamp('2025-09-22 21:13:27.918675'), 'date__495': datetime.date(2025, 9, 16), 'ticker__496': 'MSFT', 'high_price__496': 511.29, 'adj_close_price__496': 510.02, 'open_price__496': 510.62, 'stock_splits__496': 0.0, 'close_price__496': 510.02, 'data_source__496': 'yfinance', 'dividends__496': 0.0, 'volume__496': 15816585.0, 'low_price__496': 505.93, 'created_at__496': Timestamp('2025-09-22 21:13:27.918675'), 'date__496': datetime.date(2025, 9, 17), 'ticker__497': 'MSFT', 'high_price__497': 513.07, 'adj_close_price__497': 508.45, 'open_price__497': 511.49, 'stock_splits__497': 0.0, 'close_price__497': 508.45, 'data_source__497': 'yfinance', 'dividends__497': 0.0, 'volume__497': 18913696.0, 'low_price__497': 507.66, 'created_at__497': Timestamp('2025-09-22 21:13:27.918675'), 'date__497': datetime.date(2025, 9, 18), 'ticker__498': 'MSFT', 'high_price__498': 519.3, 'adj_close_price__498': 517.93, 'open_price__498': 510.56, 'stock_splits__498': 0.0, 'close_price__498': 517.93, 'data_source__498': 'yfinance', 'dividends__498': 0.0, 'volume__498': 52474093.0, 'low_price__498': 510.31, 'created_at__498': Timestamp('2025-09-22 21:13:27.918675'), 'date__498': datetime.date(2025, 9, 19), 'ticker__499': 'MSFT', 'high_price__499': 517.74, 'adj_close_price__499': 514.45, 'open_price__499': 515.59, 'stock_splits__499': 0.0, 'close_price__499': 514.45, 'data_source__499': 'yfinance', 'dividends__499': 0.0, 'volume__499': 11191485.0, 'low_price__499': 512.545, 'created_at__499': Timestamp('2025-09-22 21:13:27.918675'), 'date__499': datetime.date(2025, 9, 22)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-22 22:13:28 | ERROR | src.data_ingestion.completely_free_stock_data:load_data:384 | Batch 1 failed: (psycopg2.errors.CheckViolation) no partition of relation "stock_prices" found for row
DETAIL:  Partition key of the failing row contains (date) = (2025-01-02).

[SQL: INSERT INTO stock_prices (ticker, date, open_price, high_price, low_price, close_price, adj_close_price, volume, dividends, stock_splits, data_source, created_at) VALUES (%(ticker__0)s, %(date__0)s, %(open_price__0)s, %(high_price__0)s, %(low_price__ ... 121998 characters truncated ... volume__499)s, %(dividends__499)s, %(stock_splits__499)s, %(data_source__499)s, %(created_at__499)s)]
[parameters: {'ticker__0': 'AAPL', 'high_price__0': 228.946, 'adj_close_price__0': 225.973, 'open_price__0': 226.841, 'stock_splits__0': 0.0, 'close_price__0': 225.973, 'data_source__0': 'yfinance', 'dividends__0': 0.0, 'volume__0': 54265192.0, 'low_price__0': 225.314, 'created_at__0': Timestamp('2025-09-22 21:13:27.918675'), 'date__0': datetime.date(2024, 9, 23), 'ticker__1': 'AAPL', 'high_price__1': 228.846, 'adj_close_price__1': 226.871, 'open_price__1': 228.143, 'stock_splits__1': 0.0, 'close_price__1': 226.871, 'data_source__1': 'yfinance', 'dividends__1': 0.0, 'volume__1': 43651930.0, 'low_price__1': 225.234, 'created_at__1': Timestamp('2025-09-22 21:13:27.918675'), 'date__1': datetime.date(2024, 9, 24), 'ticker__2': 'AAPL', 'high_price__2': 226.791, 'adj_close_price__2': 225.873, 'open_price__2': 224.436, 'stock_splits__2': 0.0, 'close_price__2': 225.873, 'data_source__2': 'yfinance', 'dividends__2': 0.0, 'volume__2': 42401832.0, 'low_price__2': 223.528, 'created_at__2': Timestamp('2025-09-22 21:13:27.918675'), 'date__2': datetime.date(2024, 9, 25), 'ticker__3': 'AAPL', 'high_price__3': 227.998, 'adj_close_price__3': 227.02, 'open_price__3': 226.801, 'stock_splits__3': 0.0, 'close_price__3': 227.02, 'data_source__3': 'yfinance', 'dividends__3': 0.0, 'volume__3': 36717340.0, 'low_price__3': 224.915, 'created_at__3': Timestamp('2025-09-22 21:13:27.918675'), 'date__3': datetime.date(2024, 9, 26), 'ticker__4': 'AAPL', 'high_price__4': 229.016 ... 5900 parameters truncated ... 'created_at__495': Timestamp('2025-09-22 21:13:27.918675'), 'date__495': datetime.date(2025, 9, 16), 'ticker__496': 'MSFT', 'high_price__496': 511.29, 'adj_close_price__496': 510.02, 'open_price__496': 510.62, 'stock_splits__496': 0.0, 'close_price__496': 510.02, 'data_source__496': 'yfinance', 'dividends__496': 0.0, 'volume__496': 15816585.0, 'low_price__496': 505.93, 'created_at__496': Timestamp('2025-09-22 21:13:27.918675'), 'date__496': datetime.date(2025, 9, 17), 'ticker__497': 'MSFT', 'high_price__497': 513.07, 'adj_close_price__497': 508.45, 'open_price__497': 511.49, 'stock_splits__497': 0.0, 'close_price__497': 508.45, 'data_source__497': 'yfinance', 'dividends__497': 0.0, 'volume__497': 18913696.0, 'low_price__497': 507.66, 'created_at__497': Timestamp('2025-09-22 21:13:27.918675'), 'date__497': datetime.date(2025, 9, 18), 'ticker__498': 'MSFT', 'high_price__498': 519.3, 'adj_close_price__498': 517.93, 'open_price__498': 510.56, 'stock_splits__498': 0.0, 'close_price__498': 517.93, 'data_source__498': 'yfinance', 'dividends__498': 0.0, 'volume__498': 52474093.0, 'low_price__498': 510.31, 'created_at__498': Timestamp('2025-09-22 21:13:27.918675'), 'date__498': datetime.date(2025, 9, 19), 'ticker__499': 'MSFT', 'high_price__499': 517.74, 'adj_close_price__499': 514.45, 'open_price__499': 515.59, 'stock_splits__499': 0.0, 'close_price__499': 514.45, 'data_source__499': 'yfinance', 'dividends__499': 0.0, 'volume__499': 11191485.0, 'low_price__499': 512.545, 'created_at__499': Timestamp('2025-09-22 21:13:27.918675'), 'date__499': datetime.date(2025, 9, 22)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-22 22:13:28 | ERROR | src.models.database:get_session:165 | Database session error: (psycopg2.errors.CheckViolation) no partition of relation "stock_prices" found for row
DETAIL:  Partition key of the failing row contains (date) = (2025-01-02).

[SQL: INSERT INTO stock_prices (ticker, date, open_price, high_price, low_price, close_price, adj_close_price, volume, dividends, stock_splits, data_source, created_at) VALUES (%(ticker__0)s, %(date__0)s, %(open_price__0)s, %(high_price__0)s, %(low_price__ ... 121998 characters truncated ... volume__499)s, %(dividends__499)s, %(stock_splits__499)s, %(data_source__499)s, %(created_at__499)s)]
[parameters: {'ticker__0': 'GOOGL', 'high_price__0': 165.301, 'adj_close_price__0': 161.665, 'open_price__0': 164.162, 'stock_splits__0': 0.0, 'close_price__0': 161.665, 'data_source__0': 'yfinance', 'dividends__0': 0.0, 'volume__0': 24178530.0, 'low_price__0': 161.485, 'created_at__0': Timestamp('2025-09-22 21:13:27.918675'), 'date__0': datetime.date(2024, 9, 23), 'ticker__1': 'GOOGL', 'high_price__1': 163.029, 'adj_close_price__1': 162.104, 'open_price__1': 162.843, 'stock_splits__1': 0.0, 'close_price__1': 162.104, 'data_source__1': 'yfinance', 'dividends__1': 0.0, 'volume__1': 23358887.0, 'low_price__1': 160.506, 'created_at__1': Timestamp('2025-09-22 21:13:27.918675'), 'date__1': datetime.date(2024, 9, 24), 'ticker__2': 'GOOGL', 'high_price__2': 162.624, 'adj_close_price__2': 161.305, 'open_price__2': 161.285, 'stock_splits__2': 0.0, 'close_price__2': 161.305, 'data_source__2': 'yfinance', 'dividends__2': 0.0, 'volume__2': 18890824.0, 'low_price__2': 161.115, 'created_at__2': Timestamp('2025-09-22 21:13:27.918675'), 'date__2': datetime.date(2024, 9, 25), 'ticker__3': 'GOOGL', 'high_price__3': 163.892, 'adj_close_price__3': 162.544, 'open_price__3': 163.453, 'stock_splits__3': 0.0, 'close_price__3': 162.544, 'data_source__3': 'yfinance', 'dividends__3': 0.0, 'volume__3': 20342623.0, 'low_price__3': 162.094, 'created_at__3': Timestamp('2025-09-22 21:13:27.918675'), 'date__3': datetime.date(2024, 9, 26), 'ticker__4': 'GOOGL', 'high_price__4': 165.51 ... 5900 parameters truncated ... 'created_at__495': Timestamp('2025-09-22 21:13:27.918675'), 'date__495': datetime.date(2025, 9, 16), 'ticker__496': 'AMZN', 'high_price__496': 234.3, 'adj_close_price__496': 231.62, 'open_price__496': 233.77, 'stock_splits__496': 0.0, 'close_price__496': 231.62, 'data_source__496': 'yfinance', 'dividends__496': 0.0, 'volume__496': 42815230.0, 'low_price__496': 228.71, 'created_at__496': Timestamp('2025-09-22 21:13:27.918675'), 'date__496': datetime.date(2025, 9, 17), 'ticker__497': 'AMZN', 'high_price__497': 233.48, 'adj_close_price__497': 231.23, 'open_price__497': 232.5, 'stock_splits__497': 0.0, 'close_price__497': 231.23, 'data_source__497': 'yfinance', 'dividends__497': 0.0, 'volume__497': 37931738.0, 'low_price__497': 228.79, 'created_at__497': Timestamp('2025-09-22 21:13:27.918675'), 'date__497': datetime.date(2025, 9, 18), 'ticker__498': 'AMZN', 'high_price__498': 234.16, 'adj_close_price__498': 231.48, 'open_price__498': 232.37, 'stock_splits__498': 0.0, 'close_price__498': 231.48, 'data_source__498': 'yfinance', 'dividends__498': 0.0, 'volume__498': 97943172.0, 'low_price__498': 229.7, 'created_at__498': Timestamp('2025-09-22 21:13:27.918675'), 'date__498': datetime.date(2025, 9, 19), 'ticker__499': 'AMZN', 'high_price__499': 230.565, 'adj_close_price__499': 227.63, 'open_price__499': 230.56, 'stock_splits__499': 0.0, 'close_price__499': 227.63, 'data_source__499': 'yfinance', 'dividends__499': 0.0, 'volume__499': 31614708.0, 'low_price__499': 227.51, 'created_at__499': Timestamp('2025-09-22 21:13:27.918675'), 'date__499': datetime.date(2025, 9, 22)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-22 22:13:28 | ERROR | src.data_ingestion.completely_free_stock_data:load_data:384 | Batch 2 failed: (psycopg2.errors.CheckViolation) no partition of relation "stock_prices" found for row
DETAIL:  Partition key of the failing row contains (date) = (2025-01-02).

[SQL: INSERT INTO stock_prices (ticker, date, open_price, high_price, low_price, close_price, adj_close_price, volume, dividends, stock_splits, data_source, created_at) VALUES (%(ticker__0)s, %(date__0)s, %(open_price__0)s, %(high_price__0)s, %(low_price__ ... 121998 characters truncated ... volume__499)s, %(dividends__499)s, %(stock_splits__499)s, %(data_source__499)s, %(created_at__499)s)]
[parameters: {'ticker__0': 'GOOGL', 'high_price__0': 165.301, 'adj_close_price__0': 161.665, 'open_price__0': 164.162, 'stock_splits__0': 0.0, 'close_price__0': 161.665, 'data_source__0': 'yfinance', 'dividends__0': 0.0, 'volume__0': 24178530.0, 'low_price__0': 161.485, 'created_at__0': Timestamp('2025-09-22 21:13:27.918675'), 'date__0': datetime.date(2024, 9, 23), 'ticker__1': 'GOOGL', 'high_price__1': 163.029, 'adj_close_price__1': 162.104, 'open_price__1': 162.843, 'stock_splits__1': 0.0, 'close_price__1': 162.104, 'data_source__1': 'yfinance', 'dividends__1': 0.0, 'volume__1': 23358887.0, 'low_price__1': 160.506, 'created_at__1': Timestamp('2025-09-22 21:13:27.918675'), 'date__1': datetime.date(2024, 9, 24), 'ticker__2': 'GOOGL', 'high_price__2': 162.624, 'adj_close_price__2': 161.305, 'open_price__2': 161.285, 'stock_splits__2': 0.0, 'close_price__2': 161.305, 'data_source__2': 'yfinance', 'dividends__2': 0.0, 'volume__2': 18890824.0, 'low_price__2': 161.115, 'created_at__2': Timestamp('2025-09-22 21:13:27.918675'), 'date__2': datetime.date(2024, 9, 25), 'ticker__3': 'GOOGL', 'high_price__3': 163.892, 'adj_close_price__3': 162.544, 'open_price__3': 163.453, 'stock_splits__3': 0.0, 'close_price__3': 162.544, 'data_source__3': 'yfinance', 'dividends__3': 0.0, 'volume__3': 20342623.0, 'low_price__3': 162.094, 'created_at__3': Timestamp('2025-09-22 21:13:27.918675'), 'date__3': datetime.date(2024, 9, 26), 'ticker__4': 'GOOGL', 'high_price__4': 165.51 ... 5900 parameters truncated ... 'created_at__495': Timestamp('2025-09-22 21:13:27.918675'), 'date__495': datetime.date(2025, 9, 16), 'ticker__496': 'AMZN', 'high_price__496': 234.3, 'adj_close_price__496': 231.62, 'open_price__496': 233.77, 'stock_splits__496': 0.0, 'close_price__496': 231.62, 'data_source__496': 'yfinance', 'dividends__496': 0.0, 'volume__496': 42815230.0, 'low_price__496': 228.71, 'created_at__496': Timestamp('2025-09-22 21:13:27.918675'), 'date__496': datetime.date(2025, 9, 17), 'ticker__497': 'AMZN', 'high_price__497': 233.48, 'adj_close_price__497': 231.23, 'open_price__497': 232.5, 'stock_splits__497': 0.0, 'close_price__497': 231.23, 'data_source__497': 'yfinance', 'dividends__497': 0.0, 'volume__497': 37931738.0, 'low_price__497': 228.79, 'created_at__497': Timestamp('2025-09-22 21:13:27.918675'), 'date__497': datetime.date(2025, 9, 18), 'ticker__498': 'AMZN', 'high_price__498': 234.16, 'adj_close_price__498': 231.48, 'open_price__498': 232.37, 'stock_splits__498': 0.0, 'close_price__498': 231.48, 'data_source__498': 'yfinance', 'dividends__498': 0.0, 'volume__498': 97943172.0, 'low_price__498': 229.7, 'created_at__498': Timestamp('2025-09-22 21:13:27.918675'), 'date__498': datetime.date(2025, 9, 19), 'ticker__499': 'AMZN', 'high_price__499': 230.565, 'adj_close_price__499': 227.63, 'open_price__499': 230.56, 'stock_splits__499': 0.0, 'close_price__499': 227.63, 'data_source__499': 'yfinance', 'dividends__499': 0.0, 'volume__499': 31614708.0, 'low_price__499': 227.51, 'created_at__499': Timestamp('2025-09-22 21:13:27.918675'), 'date__499': datetime.date(2025, 9, 22)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-22 22:13:29 | ERROR | src.models.database:get_session:165 | Database session error: (psycopg2.errors.CheckViolation) no partition of relation "stock_prices" found for row
DETAIL:  Partition key of the failing row contains (date) = (2025-01-02).

[SQL: INSERT INTO stock_prices (ticker, date, open_price, high_price, low_price, close_price, adj_close_price, volume, dividends, stock_splits, data_source, created_at) VALUES (%(ticker__0)s, %(date__0)s, %(open_price__0)s, %(high_price__0)s, %(low_price__ ... 121998 characters truncated ... volume__499)s, %(dividends__499)s, %(stock_splits__499)s, %(data_source__499)s, %(created_at__499)s)]
[parameters: {'ticker__0': 'TSLA', 'high_price__0': 250.0, 'adj_close_price__0': 250.0, 'open_price__0': 242.61, 'stock_splits__0': 0.0, 'close_price__0': 250.0, 'data_source__0': 'yfinance', 'dividends__0': 0.0, 'volume__0': 86927194.0, 'low_price__0': 241.92, 'created_at__0': Timestamp('2025-09-22 21:13:27.918675'), 'date__0': datetime.date(2024, 9, 23), 'ticker__1': 'TSLA', 'high_price__1': 257.19, 'adj_close_price__1': 254.27, 'open_price__1': 254.08, 'stock_splits__1': 0.0, 'close_price__1': 254.27, 'data_source__1': 'yfinance', 'dividends__1': 0.0, 'volume__1': 88490999.0, 'low_price__1': 249.0501, 'created_at__1': Timestamp('2025-09-22 21:13:27.918675'), 'date__1': datetime.date(2024, 9, 24), 'ticker__2': 'TSLA', 'high_price__2': 257.05, 'adj_close_price__2': 257.02, 'open_price__2': 252.54, 'stock_splits__2': 0.0, 'close_price__2': 257.02, 'data_source__2': 'yfinance', 'dividends__2': 0.0, 'volume__2': 65034318.0, 'low_price__2': 252.28, 'created_at__2': Timestamp('2025-09-22 21:13:27.918675'), 'date__2': datetime.date(2024, 9, 25), 'ticker__3': 'TSLA', 'high_price__3': 261.75, 'adj_close_price__3': 254.22, 'open_price__3': 260.6, 'stock_splits__3': 0.0, 'close_price__3': 254.22, 'data_source__3': 'yfinance', 'dividends__3': 0.0, 'volume__3': 67142193.0, 'low_price__3': 251.53, 'created_at__3': Timestamp('2025-09-22 21:13:27.918675'), 'date__3': datetime.date(2024, 9, 26), 'ticker__4': 'TSLA', 'high_price__4': 260.6999 ... 5900 parameters truncated ... 'created_at__495': Timestamp('2025-09-22 21:13:27.918675'), 'date__495': datetime.date(2025, 9, 16), 'ticker__496': 'NVDA', 'high_price__496': 173.2, 'adj_close_price__496': 170.29, 'open_price__496': 172.64, 'stock_splits__496': 0.0, 'close_price__496': 170.29, 'data_source__496': 'yfinance', 'dividends__496': 0.0, 'volume__496': 211843817.0, 'low_price__496': 168.41, 'created_at__496': Timestamp('2025-09-22 21:13:27.918675'), 'date__496': datetime.date(2025, 9, 17), 'ticker__497': 'NVDA', 'high_price__497': 177.1, 'adj_close_price__497': 176.24, 'open_price__497': 173.98, 'stock_splits__497': 0.0, 'close_price__497': 176.24, 'data_source__497': 'yfinance', 'dividends__497': 0.0, 'volume__497': 191763313.0, 'low_price__497': 172.96, 'created_at__497': Timestamp('2025-09-22 21:13:27.918675'), 'date__497': datetime.date(2025, 9, 18), 'ticker__498': 'NVDA', 'high_price__498': 178.08, 'adj_close_price__498': 176.67, 'open_price__498': 175.77, 'stock_splits__498': 0.0, 'close_price__498': 176.67, 'data_source__498': 'yfinance', 'dividends__498': 0.0, 'volume__498': 237182143.0, 'low_price__498': 175.18, 'created_at__498': Timestamp('2025-09-22 21:13:27.918675'), 'date__498': datetime.date(2025, 9, 19), 'ticker__499': 'NVDA', 'high_price__499': 184.55, 'adj_close_price__499': 183.61, 'open_price__499': 175.3, 'stock_splits__499': 0.0, 'close_price__499': 183.61, 'data_source__499': 'yfinance', 'dividends__499': 0.0, 'volume__499': 216796711.0, 'low_price__499': 174.7053, 'created_at__499': Timestamp('2025-09-22 21:13:27.918675'), 'date__499': datetime.date(2025, 9, 22)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-22 22:13:29 | ERROR | src.data_ingestion.completely_free_stock_data:load_data:384 | Batch 3 failed: (psycopg2.errors.CheckViolation) no partition of relation "stock_prices" found for row
DETAIL:  Partition key of the failing row contains (date) = (2025-01-02).

[SQL: INSERT INTO stock_prices (ticker, date, open_price, high_price, low_price, close_price, adj_close_price, volume, dividends, stock_splits, data_source, created_at) VALUES (%(ticker__0)s, %(date__0)s, %(open_price__0)s, %(high_price__0)s, %(low_price__ ... 121998 characters truncated ... volume__499)s, %(dividends__499)s, %(stock_splits__499)s, %(data_source__499)s, %(created_at__499)s)]
[parameters: {'ticker__0': 'TSLA', 'high_price__0': 250.0, 'adj_close_price__0': 250.0, 'open_price__0': 242.61, 'stock_splits__0': 0.0, 'close_price__0': 250.0, 'data_source__0': 'yfinance', 'dividends__0': 0.0, 'volume__0': 86927194.0, 'low_price__0': 241.92, 'created_at__0': Timestamp('2025-09-22 21:13:27.918675'), 'date__0': datetime.date(2024, 9, 23), 'ticker__1': 'TSLA', 'high_price__1': 257.19, 'adj_close_price__1': 254.27, 'open_price__1': 254.08, 'stock_splits__1': 0.0, 'close_price__1': 254.27, 'data_source__1': 'yfinance', 'dividends__1': 0.0, 'volume__1': 88490999.0, 'low_price__1': 249.0501, 'created_at__1': Timestamp('2025-09-22 21:13:27.918675'), 'date__1': datetime.date(2024, 9, 24), 'ticker__2': 'TSLA', 'high_price__2': 257.05, 'adj_close_price__2': 257.02, 'open_price__2': 252.54, 'stock_splits__2': 0.0, 'close_price__2': 257.02, 'data_source__2': 'yfinance', 'dividends__2': 0.0, 'volume__2': 65034318.0, 'low_price__2': 252.28, 'created_at__2': Timestamp('2025-09-22 21:13:27.918675'), 'date__2': datetime.date(2024, 9, 25), 'ticker__3': 'TSLA', 'high_price__3': 261.75, 'adj_close_price__3': 254.22, 'open_price__3': 260.6, 'stock_splits__3': 0.0, 'close_price__3': 254.22, 'data_source__3': 'yfinance', 'dividends__3': 0.0, 'volume__3': 67142193.0, 'low_price__3': 251.53, 'created_at__3': Timestamp('2025-09-22 21:13:27.918675'), 'date__3': datetime.date(2024, 9, 26), 'ticker__4': 'TSLA', 'high_price__4': 260.6999 ... 5900 parameters truncated ... 'created_at__495': Timestamp('2025-09-22 21:13:27.918675'), 'date__495': datetime.date(2025, 9, 16), 'ticker__496': 'NVDA', 'high_price__496': 173.2, 'adj_close_price__496': 170.29, 'open_price__496': 172.64, 'stock_splits__496': 0.0, 'close_price__496': 170.29, 'data_source__496': 'yfinance', 'dividends__496': 0.0, 'volume__496': 211843817.0, 'low_price__496': 168.41, 'created_at__496': Timestamp('2025-09-22 21:13:27.918675'), 'date__496': datetime.date(2025, 9, 17), 'ticker__497': 'NVDA', 'high_price__497': 177.1, 'adj_close_price__497': 176.24, 'open_price__497': 173.98, 'stock_splits__497': 0.0, 'close_price__497': 176.24, 'data_source__497': 'yfinance', 'dividends__497': 0.0, 'volume__497': 191763313.0, 'low_price__497': 172.96, 'created_at__497': Timestamp('2025-09-22 21:13:27.918675'), 'date__497': datetime.date(2025, 9, 18), 'ticker__498': 'NVDA', 'high_price__498': 178.08, 'adj_close_price__498': 176.67, 'open_price__498': 175.77, 'stock_splits__498': 0.0, 'close_price__498': 176.67, 'data_source__498': 'yfinance', 'dividends__498': 0.0, 'volume__498': 237182143.0, 'low_price__498': 175.18, 'created_at__498': Timestamp('2025-09-22 21:13:27.918675'), 'date__498': datetime.date(2025, 9, 19), 'ticker__499': 'NVDA', 'high_price__499': 184.55, 'adj_close_price__499': 183.61, 'open_price__499': 175.3, 'stock_splits__499': 0.0, 'close_price__499': 183.61, 'data_source__499': 'yfinance', 'dividends__499': 0.0, 'volume__499': 216796711.0, 'low_price__499': 174.7053, 'created_at__499': Timestamp('2025-09-22 21:13:27.918675'), 'date__499': datetime.date(2025, 9, 22)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-22 22:13:29 | ERROR | src.models.database:get_session:165 | Database session error: (psycopg2.errors.CheckViolation) no partition of relation "stock_prices" found for row
DETAIL:  Partition key of the failing row contains (date) = (2025-01-02).

[SQL: INSERT INTO stock_prices (ticker, date, open_price, high_price, low_price, close_price, adj_close_price, volume, dividends, stock_splits, data_source, created_at) VALUES (%(ticker__0)s, %(date__0)s, %(open_price__0)s, %(high_price__0)s, %(low_price__ ... 121998 characters truncated ... volume__499)s, %(dividends__499)s, %(stock_splits__499)s, %(data_source__499)s, %(created_at__499)s)]
[parameters: {'ticker__0': 'META', 'high_price__0': 573.9799, 'adj_close_price__0': 564.41, 'open_price__0': 569.5, 'stock_splits__0': 0.0, 'close_price__0': 564.41, 'data_source__0': 'yfinance', 'dividends__0': 0.0, 'volume__0': 12830669.0, 'low_price__0': 562.41, 'created_at__0': Timestamp('2025-09-22 21:13:27.918675'), 'date__0': datetime.date(2024, 9, 23), 'ticker__1': 'META', 'high_price__1': 567.745, 'adj_close_price__1': 563.33, 'open_price__1': 566.68, 'stock_splits__1': 0.0, 'close_price__1': 563.33, 'data_source__1': 'yfinance', 'dividends__1': 0.0, 'volume__1': 12992956.0, 'low_price__1': 554.19, 'created_at__1': Timestamp('2025-09-22 21:13:27.918675'), 'date__1': datetime.date(2024, 9, 24), 'ticker__2': 'META', 'high_price__2': 576.88, 'adj_close_price__2': 568.31, 'open_price__2': 564.05, 'stock_splits__2': 0.0, 'close_price__2': 568.31, 'data_source__2': 'yfinance', 'dividends__2': 0.0, 'volume__2': 16543350.0, 'low_price__2': 563.72, 'created_at__2': Timestamp('2025-09-22 21:13:27.918675'), 'date__2': datetime.date(2024, 9, 25), 'ticker__3': 'META', 'high_price__3': 577.4, 'adj_close_price__3': 567.84, 'open_price__3': 575.73, 'stock_splits__3': 0.0, 'close_price__3': 567.84, 'data_source__3': 'yfinance', 'dividends__3': 0.0, 'volume__3': 14400787.0, 'low_price__3': 562.3501, 'created_at__3': Timestamp('2025-09-22 21:13:27.918675'), 'date__3': datetime.date(2024, 9, 26), 'ticker__4': 'META', 'high_price__4': 570.8399 ... 5900 parameters truncated ... 'created_at__495': Timestamp('2025-09-22 21:13:27.918675'), 'date__495': datetime.date(2025, 9, 16), 'ticker__496': 'NFLX', 'high_price__496': 1233.93, 'adj_close_price__496': 1228.5, 'open_price__496': 1221.02, 'stock_splits__496': 0.0, 'close_price__496': 1228.5, 'data_source__496': 'yfinance', 'dividends__496': 0.0, 'volume__496': 3459796.0, 'low_price__496': 1206.605, 'created_at__496': Timestamp('2025-09-22 21:13:27.918675'), 'date__496': datetime.date(2025, 9, 17), 'ticker__497': 'NFLX', 'high_price__497': 1233.0, 'adj_close_price__497': 1207.78, 'open_price__497': 1220.82, 'stock_splits__497': 0.0, 'close_price__497': 1207.78, 'data_source__497': 'yfinance', 'dividends__497': 0.0, 'volume__497': 3169105.0, 'low_price__497': 1205.5, 'created_at__497': Timestamp('2025-09-22 21:13:27.918675'), 'date__497': datetime.date(2025, 9, 18), 'ticker__498': 'NFLX', 'high_price__498': 1229.9499, 'adj_close_price__498': 1226.97, 'open_price__498': 1218.62, 'stock_splits__498': 0.0, 'close_price__498': 1226.97, 'data_source__498': 'yfinance', 'dividends__498': 0.0, 'volume__498': 4947590.0, 'low_price__498': 1208.1, 'created_at__498': Timestamp('2025-09-22 21:13:27.918675'), 'date__498': datetime.date(2025, 9, 19), 'ticker__499': 'NFLX', 'high_price__499': 1229.76, 'adj_close_price__499': 1227.37, 'open_price__499': 1221.9, 'stock_splits__499': 0.0, 'close_price__499': 1227.37, 'data_source__499': 'yfinance', 'dividends__499': 0.0, 'volume__499': 1253582.0, 'low_price__499': 1214.2432, 'created_at__499': Timestamp('2025-09-22 21:13:27.918675'), 'date__499': datetime.date(2025, 9, 22)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-22 22:13:29 | ERROR | src.data_ingestion.completely_free_stock_data:load_data:384 | Batch 4 failed: (psycopg2.errors.CheckViolation) no partition of relation "stock_prices" found for row
DETAIL:  Partition key of the failing row contains (date) = (2025-01-02).

[SQL: INSERT INTO stock_prices (ticker, date, open_price, high_price, low_price, close_price, adj_close_price, volume, dividends, stock_splits, data_source, created_at) VALUES (%(ticker__0)s, %(date__0)s, %(open_price__0)s, %(high_price__0)s, %(low_price__ ... 121998 characters truncated ... volume__499)s, %(dividends__499)s, %(stock_splits__499)s, %(data_source__499)s, %(created_at__499)s)]
[parameters: {'ticker__0': 'META', 'high_price__0': 573.9799, 'adj_close_price__0': 564.41, 'open_price__0': 569.5, 'stock_splits__0': 0.0, 'close_price__0': 564.41, 'data_source__0': 'yfinance', 'dividends__0': 0.0, 'volume__0': 12830669.0, 'low_price__0': 562.41, 'created_at__0': Timestamp('2025-09-22 21:13:27.918675'), 'date__0': datetime.date(2024, 9, 23), 'ticker__1': 'META', 'high_price__1': 567.745, 'adj_close_price__1': 563.33, 'open_price__1': 566.68, 'stock_splits__1': 0.0, 'close_price__1': 563.33, 'data_source__1': 'yfinance', 'dividends__1': 0.0, 'volume__1': 12992956.0, 'low_price__1': 554.19, 'created_at__1': Timestamp('2025-09-22 21:13:27.918675'), 'date__1': datetime.date(2024, 9, 24), 'ticker__2': 'META', 'high_price__2': 576.88, 'adj_close_price__2': 568.31, 'open_price__2': 564.05, 'stock_splits__2': 0.0, 'close_price__2': 568.31, 'data_source__2': 'yfinance', 'dividends__2': 0.0, 'volume__2': 16543350.0, 'low_price__2': 563.72, 'created_at__2': Timestamp('2025-09-22 21:13:27.918675'), 'date__2': datetime.date(2024, 9, 25), 'ticker__3': 'META', 'high_price__3': 577.4, 'adj_close_price__3': 567.84, 'open_price__3': 575.73, 'stock_splits__3': 0.0, 'close_price__3': 567.84, 'data_source__3': 'yfinance', 'dividends__3': 0.0, 'volume__3': 14400787.0, 'low_price__3': 562.3501, 'created_at__3': Timestamp('2025-09-22 21:13:27.918675'), 'date__3': datetime.date(2024, 9, 26), 'ticker__4': 'META', 'high_price__4': 570.8399 ... 5900 parameters truncated ... 'created_at__495': Timestamp('2025-09-22 21:13:27.918675'), 'date__495': datetime.date(2025, 9, 16), 'ticker__496': 'NFLX', 'high_price__496': 1233.93, 'adj_close_price__496': 1228.5, 'open_price__496': 1221.02, 'stock_splits__496': 0.0, 'close_price__496': 1228.5, 'data_source__496': 'yfinance', 'dividends__496': 0.0, 'volume__496': 3459796.0, 'low_price__496': 1206.605, 'created_at__496': Timestamp('2025-09-22 21:13:27.918675'), 'date__496': datetime.date(2025, 9, 17), 'ticker__497': 'NFLX', 'high_price__497': 1233.0, 'adj_close_price__497': 1207.78, 'open_price__497': 1220.82, 'stock_splits__497': 0.0, 'close_price__497': 1207.78, 'data_source__497': 'yfinance', 'dividends__497': 0.0, 'volume__497': 3169105.0, 'low_price__497': 1205.5, 'created_at__497': Timestamp('2025-09-22 21:13:27.918675'), 'date__497': datetime.date(2025, 9, 18), 'ticker__498': 'NFLX', 'high_price__498': 1229.9499, 'adj_close_price__498': 1226.97, 'open_price__498': 1218.62, 'stock_splits__498': 0.0, 'close_price__498': 1226.97, 'data_source__498': 'yfinance', 'dividends__498': 0.0, 'volume__498': 4947590.0, 'low_price__498': 1208.1, 'created_at__498': Timestamp('2025-09-22 21:13:27.918675'), 'date__498': datetime.date(2025, 9, 19), 'ticker__499': 'NFLX', 'high_price__499': 1229.76, 'adj_close_price__499': 1227.37, 'open_price__499': 1221.9, 'stock_splits__499': 0.0, 'close_price__499': 1227.37, 'data_source__499': 'yfinance', 'dividends__499': 0.0, 'volume__499': 1253582.0, 'low_price__499': 1214.2432, 'created_at__499': Timestamp('2025-09-22 21:13:27.918675'), 'date__499': datetime.date(2025, 9, 22)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-22 22:13:29 | INFO | src.data_ingestion.completely_free_stock_data:load_data:387 | Load complete: 2000 inserted, 2000 failed
2025-09-22 22:13:29 | INFO | src.data_ingestion.base_ingestion:run_ingestion:178 | Ingestion completed: 2000 inserted, 0 updated, 2000 failed
2025-09-22 22:20:43 | INFO | src.data_ingestion.base_ingestion:run_ingestion:139 | Starting ingestion job: completely_free_stock_data
2025-09-22 22:20:43 | INFO | src.data_ingestion.base_ingestion:run_ingestion:142 | Extracting data...
2025-09-22 22:20:43 | INFO | src.data_ingestion.completely_free_stock_data:extract_data:59 | Extracting 100% free data for 10 tickers from 2024-09-22 22:20:43.919536 to 2025-09-22 22:20:43.919536
2025-09-22 22:20:43 | INFO | src.data_ingestion.completely_free_stock_data:extract_data:70 | ðŸ”„ Trying Stooq (Polish Exchange)...
2025-09-22 22:20:56 | INFO | src.data_ingestion.completely_free_stock_data:_extract_from_stooq:145 | Stooq total: 2000 records
2025-09-22 22:20:56 | INFO | src.data_ingestion.completely_free_stock_data:extract_data:75 | âœ… Stooq (Polish Exchange) succeeded: 2000 records
2025-09-22 22:20:56 | INFO | src.data_ingestion.base_ingestion:run_ingestion:145 | Extracted 2000 records
2025-09-22 22:20:56 | INFO | src.data_ingestion.base_ingestion:run_ingestion:153 | Transforming data...
2025-09-22 22:20:56 | INFO | src.data_ingestion.completely_free_stock_data:transform_data:305 | Transforming completely free stock data...
2025-09-22 22:20:56 | INFO | src.data_ingestion.base_ingestion:validate_stock_data:203 | Validating stock data quality...
2025-09-22 22:20:56 | INFO | src.data_ingestion.base_ingestion:validate_stock_data:230 | Data quality validation: 0 records removed, 2000 records retained
2025-09-22 22:20:56 | INFO | src.data_ingestion.completely_free_stock_data:transform_data:340 | Transformation complete: 2000 clean records
2025-09-22 22:20:56 | INFO | src.data_ingestion.base_ingestion:run_ingestion:155 | Transformed data: 2000 records
2025-09-22 22:20:56 | INFO | src.data_ingestion.base_ingestion:run_ingestion:158 | Loading data into database...
2025-09-22 22:20:56 | INFO | src.data_ingestion.completely_free_stock_data:load_data:345 | Loading completely free stock data...
2025-09-22 22:20:58 | INFO | src.data_ingestion.completely_free_stock_data:load_data:387 | Load complete: 2000 inserted, 0 failed
2025-09-22 22:20:58 | INFO | src.data_ingestion.base_ingestion:run_ingestion:178 | Ingestion completed: 2000 inserted, 0 updated, 0 failed
2025-09-22 22:40:36 | INFO | src.data_ingestion.base_ingestion:run_ingestion:139 | Starting ingestion job: fred_economic_data
2025-09-22 22:40:36 | INFO | src.data_ingestion.base_ingestion:run_ingestion:142 | Extracting data...
2025-09-22 22:40:36 | INFO | src.data_ingestion.fred_economic_data:extract_data:85 | Extracting FRED data for 23 indicators from 2005-09-27 22:40:36.267648 to 2025-09-22 22:40:36.267648
2025-09-22 22:41:15 | INFO | src.data_ingestion.fred_economic_data:extract_data:164 | FRED extraction complete: 29002 records from 23 series
2025-09-22 22:41:15 | INFO | src.data_ingestion.base_ingestion:run_ingestion:145 | Extracted 29002 records
2025-09-22 22:41:15 | INFO | src.data_ingestion.base_ingestion:run_ingestion:153 | Transforming data...
2025-09-22 22:41:15 | INFO | src.data_ingestion.fred_economic_data:transform_data:211 | Transforming FRED economic data...
2025-09-22 22:41:15 | INFO | src.data_ingestion.fred_economic_data:transform_data:252 | FRED transformation complete: 239 records removed, 28763 records retained
2025-09-22 22:41:15 | INFO | src.data_ingestion.base_ingestion:run_ingestion:155 | Transformed data: 28763 records
2025-09-22 22:41:15 | INFO | src.data_ingestion.base_ingestion:run_ingestion:158 | Loading data into database...
2025-09-22 22:41:15 | INFO | src.data_ingestion.fred_economic_data:load_data:257 | Loading FRED economic data into database...
2025-09-22 22:41:37 | INFO | src.data_ingestion.fred_economic_data:load_data:300 | FRED load complete: 28763 inserted, 0 updated, 0 failed
2025-09-22 22:41:37 | INFO | src.data_ingestion.base_ingestion:run_ingestion:178 | Ingestion completed: 28763 inserted, 0 updated, 0 failed
2025-09-22 22:41:37 | INFO | src.data_ingestion.base_ingestion:run_ingestion:139 | Starting ingestion job: coingecko_crypto_data
2025-09-22 22:41:37 | INFO | src.data_ingestion.base_ingestion:run_ingestion:142 | Extracting data...
2025-09-22 22:41:37 | INFO | src.data_ingestion.crypto_data_ingestion:extract_data:61 | Extracting CoinGecko data for 20 cryptocurrencies from 2024-09-22 22:41:37.678358 to 2025-09-22 22:41:37.678358
2025-09-22 22:41:38 | WARNING | src.data_ingestion.crypto_data_ingestion:extract_data:126 | Failed to process data for bitcoin: can't compare datetime.datetime to datetime.date
2025-09-22 22:41:44 | WARNING | src.data_ingestion.crypto_data_ingestion:extract_data:126 | Failed to process data for ethereum: can't compare datetime.datetime to datetime.date
2025-09-22 22:41:51 | WARNING | src.data_ingestion.crypto_data_ingestion:extract_data:126 | Failed to process data for tether: can't compare datetime.datetime to datetime.date
2025-09-22 22:41:57 | WARNING | src.data_ingestion.crypto_data_ingestion:extract_data:132 | Failed to fetch bnb: HTTP 404
2025-09-22 22:42:03 | WARNING | src.data_ingestion.crypto_data_ingestion:extract_data:126 | Failed to process data for solana: can't compare datetime.datetime to datetime.date
2025-09-22 22:42:09 | WARNING | src.data_ingestion.crypto_data_ingestion:extract_data:132 | Failed to fetch usdc: HTTP 404
2025-09-22 22:42:16 | WARNING | src.data_ingestion.crypto_data_ingestion:extract_data:132 | Failed to fetch steth: HTTP 404
2025-09-22 22:42:22 | WARNING | src.data_ingestion.crypto_data_ingestion:extract_data:129 | Rate limited by CoinGecko, waiting longer...
2025-09-22 22:43:28 | WARNING | src.data_ingestion.crypto_data_ingestion:extract_data:126 | Failed to process data for dogecoin: can't compare datetime.datetime to datetime.date
2025-09-22 22:43:34 | WARNING | src.data_ingestion.crypto_data_ingestion:extract_data:132 | Failed to fetch toncoin: HTTP 404
2025-09-22 22:43:41 | WARNING | src.data_ingestion.crypto_data_ingestion:extract_data:126 | Failed to process data for cardano: can't compare datetime.datetime to datetime.date
2025-09-22 22:43:47 | WARNING | src.data_ingestion.crypto_data_ingestion:extract_data:126 | Failed to process data for avalanche-2: can't compare datetime.datetime to datetime.date
2025-09-22 22:43:53 | WARNING | src.data_ingestion.crypto_data_ingestion:extract_data:126 | Failed to process data for shiba-inu: can't compare datetime.datetime to datetime.date
2025-09-22 22:43:59 | WARNING | src.data_ingestion.crypto_data_ingestion:extract_data:129 | Rate limited by CoinGecko, waiting longer...
2025-09-22 22:45:05 | WARNING | src.data_ingestion.crypto_data_ingestion:extract_data:126 | Failed to process data for bitcoin-cash: can't compare datetime.datetime to datetime.date
2025-09-22 22:45:12 | WARNING | src.data_ingestion.crypto_data_ingestion:extract_data:126 | Failed to process data for polkadot: can't compare datetime.datetime to datetime.date
2025-09-22 22:45:18 | WARNING | src.data_ingestion.crypto_data_ingestion:extract_data:126 | Failed to process data for near: can't compare datetime.datetime to datetime.date
2025-09-22 22:45:25 | WARNING | src.data_ingestion.crypto_data_ingestion:extract_data:126 | Failed to process data for uniswap: can't compare datetime.datetime to datetime.date
2025-09-22 22:45:32 | WARNING | src.data_ingestion.crypto_data_ingestion:extract_data:126 | Failed to process data for litecoin: can't compare datetime.datetime to datetime.date
2025-09-22 22:45:38 | WARNING | src.data_ingestion.crypto_data_ingestion:extract_data:129 | Rate limited by CoinGecko, waiting longer...
2025-09-22 22:46:44 | WARNING | src.data_ingestion.crypto_data_ingestion:extract_data:145 | No CoinGecko data extracted
2025-09-22 22:47:48 | INFO | src.data_ingestion.base_ingestion:run_ingestion:145 | Extracted 0 records
2025-09-22 22:47:49 | WARNING | src.data_ingestion.base_ingestion:run_ingestion:148 | No data extracted, skipping transform and load
